.include "../Makefile.inc"
.PATH: ${GCCDIR}/libgcc

.if ${CCVER:Mgcc*}
CFLAGS+=	-finhibit-size-directive
CFLAGS+=	-fno-toplevel-reorder
.endif

CFLAGS+=	-fno-inline
CFLAGS+=	-fno-exceptions
CFLAGS+=	-fno-zero-initialized-in-bss
CFLAGS+=	-fno-tree-vectorize
CFLAGS+=	-fbuilding-libgcc
CFLAGS+=	-fno-stack-protector
CFLAGS+=	-fno-omit-frame-pointer
CFLAGS+=	-fno-asynchronous-unwind-tables
CFLAGS+=	-I.
CFLAGS+=	-DIN_GCC

libgcc_tm.h:
	echo "#ifndef LIBGCC_TM_H" >  ${.TARGET}
	echo "#define LIBGCC_TM_H" >> ${.TARGET}
	echo "#endif"              >> ${.TARGET}

CLEANFILES+=	libgcc_tm.h

# note: auto-host.h generated by Makefile.csu is not used.  The cc_prep
# autohost.h is loaded preferentially instead.

beforedepend: libgcc_tm.h

# calling depend may fail to find insn-constants.h, so skip this step
# seen on muscles and reproducible manually
depend: beforedepend

.include "../../csu/Makefile.csu"

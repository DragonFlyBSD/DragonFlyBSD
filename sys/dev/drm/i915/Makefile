KMOD	= i915

# core driver code
SRCS =	i915_drv.c \
	i915_params.c \
	i915_suspend.c \
	intel_pm.c

# GEM code
SRCS +=	i915_cmd_parser.c \
	i915_gem_context.c \
	i915_gem_render_state.c \
	i915_gem_evict.c \
	i915_gem_execbuffer.c \
	i915_gem_gtt.c \
	i915_gem.c \
	i915_gem_stolen.c \
	i915_gem_tiling.c \
	i915_gem_userptr.c \
	i915_irq.c \
	intel_lrc.o \
	intel_ringbuffer.c \
	intel_uncore.c

# autogenerated null render state
SRCS +=	intel_renderstate_gen6.c \
	intel_renderstate_gen7.c \
	intel_renderstate_gen8.c

# modesetting core code
SRCS += \
	intel_acpi.c \
	intel_bios.c \
	intel_display.c \
	intel_fbdev.c \
	intel_modes.c \
	intel_opregion.c \
	intel_overlay.c \
	intel_sideband.c \
	intel_sprite.c

# modesetting output/encoder code
SRCS += \
	dvo_ch7017.o \
	dvo_ch7xxx.c \
	dvo_ivch.o \
	dvo_ns2501.o \
	dvo_sil164.c \
	dvo_tfp410.o \
	intel_crt.c \
	intel_ddi.c \
	intel_dp.c \
	intel_dp_mst.c \
	intel_dsi_cmd.c \
	intel_dsi.c \
	intel_dsi_pll.c \
	intel_dsi_panel_vbt.c \
	intel_dvo.c \
	intel_hdmi.c \
	intel_i2c.c \
	intel_lvds.c \
	intel_panel.c \
	intel_sdvo.c \
	intel_tv.c

# legacy horrors
SRCS += \
	i915_dma.c \
	i915_ums.c

SRCS   += acpi_if.h device_if.h bus_if.h pci_if.h iicbus_if.h iicbb_if.h \
	  opt_acpi.h opt_drm.h opt_ktr.h

CFLAGS+= -DCONFIG_X86
CFLAGS+= -DCONFIG_ACPI
CFLAGS+= -I${SYSDIR}/dev/drm/include
CFLAGS+= -I${.CURDIR}/../../../contrib/dev/acpica/source/include

CFLAGS+= -DCONFIG_DRM_I915_FBDEV
CFLAGS+= -DCONFIG_DRM_I915_KMS
CFLAGS+= -DCONFIG_DRM_I915_PRELIMINARY_HW_SUPPORT=1

.include <bsd.kmod.mk>
